steps:
    - uses: actions/checkout@v4
    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.35.3' # Matches your project configuration
    
    - name: Install Apple Certificate
      env:
        CERTIFICATE_BASE64: ${{ secrets.P12_CERTIFICATE }}
        P12_PASSWORD: ${{ secrets.P12_PASSWORD }}
      run: |
        echo $CERTIFICATE_BASE64 | base64 --decode > certificate.p12
        # Commands to import into a temporary keychain on the runner
        
    - name: Get dependencies
      run: flutter pub get

    - name: Run code generation
      run: flutter pub run build_runner build --delete-conflicting-outputs

    - name: Build IPA
      run: flutter build ipa --release --export-options-plist=ios/ExportOptions.plist
